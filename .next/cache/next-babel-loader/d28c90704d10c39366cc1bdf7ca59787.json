{"ast":null,"code":"import _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\n\nvar _this = this,\n    _jsxFileName = \"/home/roma/Documents/shop/containers/Products/Products.tsx\",\n    _s = $RefreshSig$();\n\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  query {\\n    productList{\\n      id\\n      title\\n      slug\\n      description\\n      Type\\n      category{\\n        id\\n        title\\n        slug\\n        parent{\\n          id\\n          title\\n          slug\\n        }\\n      }\\n      unit\\n      image\\n      price\\n      salePrice\\n      discountPercent\\n      createdAt\\n      images{\\n        image\\n      }\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport { useRouter } from 'next/router';\nimport dynamic from 'next/dynamic';\nimport gql from 'graphql-tag';\nimport { openModal, closeModal } from '@redq/reuse-modal';\nimport ProductCard from 'components/ProductCard/ProductCard';\nimport { ProductsRow, ProductsCol, ButtonWrapper, LoaderWrapper, LoaderItem, ProductCardWrapper } from './Products.style';\nimport { CURRENCY } from 'helper/constant';\nimport { useQuery } from '@apollo/react-hooks';\nimport Button from 'components/Button/Button';\nimport Loader from 'components/Loader/Loader';\nimport Placeholder from 'components/Placeholder/Placeholder';\nimport Fade from 'react-reveal/Fade';\nimport NoResultFound from 'components/NoResult/NoResult';\nvar QuickView = dynamic(_c = function _c() {\n  return import('../QuickView/QuickView');\n}, {\n  loadableGenerated: {\n    webpack: function webpack() {\n      return [require.resolveWeak('../QuickView/QuickView')];\n    },\n    modules: ['../QuickView/QuickView']\n  }\n});\n_c2 = QuickView;\nvar GET_PRODUCTS = gql(_templateObject());\nexport var Products = function Products(_ref) {\n  _s();\n\n  var deviceType = _ref.deviceType,\n      type = _ref.type,\n      _ref$fetchLimit = _ref.fetchLimit,\n      fetchLimit = _ref$fetchLimit === void 0 ? 8 : _ref$fetchLimit,\n      _ref$loadMore = _ref.loadMore,\n      loadMore = _ref$loadMore === void 0 ? true : _ref$loadMore;\n  var router = useRouter();\n\n  var _useState = useState(false),\n      loadingMore = _useState[0],\n      toggleLoading = _useState[1];\n\n  var _useQuery = useQuery(GET_PRODUCTS, {// variables: {\n    //   type: type,\n    //   text: router.query.text,\n    //   category: router.query.category,\n    //   offset: 0,\n    //   limit: fetchLimit,\n    // },\n  }),\n      data = _useQuery.data,\n      error = _useQuery.error,\n      loading = _useQuery.loading,\n      fetchMore = _useQuery.fetchMore;\n\n  if (data) {\n    data = data.productList.map(function (item) {\n      return _objectSpread(_objectSpread({}, item), {}, {\n        discountInPercent: item.discountPercent\n      });\n    });\n  } // ------------------------------------------------------------------------------------------\n  // const data = {\n  //   products:{\n  //     hasMore:false,\n  //     items: fakeDB\n  //   },\n  // };\n  // const error = false;\n  // const loading = false;\n  // const fetchMore = (obj)=>{};\n  // ------------------------------------------------------------------------------------------\n  // Quick View Modal\n\n\n  var handleModalClose = function handleModalClose() {\n    var as = router.asPath;\n    router.push(as, as, {\n      shallow: true\n    });\n    closeModal();\n  };\n\n  var handleQuickViewModal = function handleQuickViewModal(modalProps, deviceType, onModalClose) {\n    if (router.pathname === '/product/[slug]') {\n      var _as = \"/product/\".concat(modalProps.slug);\n\n      router.push(router.pathname, _as);\n      return;\n    }\n\n    openModal({\n      show: true,\n      overlayClassName: 'quick-view-overlay',\n      closeOnClickOutside: false,\n      component: QuickView,\n      componentProps: {\n        modalProps: modalProps,\n        deviceType: deviceType,\n        onModalClose: onModalClose\n      },\n      closeComponent: 'div',\n      config: {\n        enableResizing: false,\n        disableDragging: true,\n        className: 'quick-view-modal',\n        width: 900,\n        y: 30,\n        height: 'auto',\n        transition: {\n          mass: 1,\n          tension: 0,\n          friction: 0\n        }\n      }\n    });\n    var href = router.asPath;\n    var as = \"/product/\".concat(modalProps.slug);\n    router.push(href, as, {\n      shallow: true\n    });\n  };\n\n  if (loading) {\n    return __jsx(LoaderWrapper, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 143,\n        columnNumber: 7\n      }\n    }, __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 145,\n        columnNumber: 11\n      }\n    })), __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 147,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 148,\n        columnNumber: 11\n      }\n    })), __jsx(LoaderItem, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 9\n      }\n    }, __jsx(Placeholder, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 11\n      }\n    })));\n  }\n\n  if (error) {\n    return __jsx(\"div\", {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 157,\n        columnNumber: 21\n      }\n    }, error.message);\n  }\n\n  ;\n\n  if (!data || !data.productList || data.productList.length === 0) {\n    return __jsx(NoResultFound, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 159,\n        columnNumber: 12\n      }\n    });\n  }\n\n  var handleLoadMore = function handleLoadMore() {\n    toggleLoading(true);\n    fetchMore({\n      variables: {\n        offset: Number(data.productList.length),\n        limit: fetchLimit\n      },\n      updateQuery: function updateQuery(prev, _ref2) {\n        var fetchMoreResult = _ref2.fetchMoreResult;\n        toggleLoading(false);\n\n        if (!fetchMoreResult) {\n          return prev;\n        }\n\n        return {\n          products: {\n            __typename: prev.products.__typename,\n            items: [].concat(_toConsumableArray(prev.products.items), _toConsumableArray(fetchMoreResult.products.items)),\n            hasMore: fetchMoreResult.products.hasMore\n          }\n        };\n      }\n    });\n  };\n\n  return __jsx(React.Fragment, null, __jsx(ProductsRow, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 7\n    }\n  }, data.productList.map(function (item, index) {\n    return __jsx(ProductsCol, {\n      key: index,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 188,\n        columnNumber: 11\n      }\n    }, __jsx(ProductCardWrapper, {\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 13\n      }\n    }, __jsx(Fade, {\n      duration: 800,\n      delay: index * 10,\n      style: {\n        height: '100%'\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 15\n      }\n    }, __jsx(ProductCard, {\n      title: item.title,\n      description: item.description,\n      image: item.image,\n      weight: item.unit,\n      currency: CURRENCY,\n      price: item.price,\n      salePrice: item.salePrice,\n      discountInPercent: item.discountInPercent,\n      data: item,\n      deviceType: deviceType,\n      onClick: function onClick() {\n        return handleQuickViewModal(item, deviceType, handleModalClose);\n      },\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 17\n      }\n    }))));\n  })), loadMore && data.hasMore && __jsx(ButtonWrapper, {\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 216,\n      columnNumber: 9\n    }\n  }, __jsx(Button, {\n    onClick: handleLoadMore,\n    title: \"Load More\",\n    intlButtonId: \"loadMoreBtn\",\n    size: \"small\",\n    isLoading: loadingMore,\n    loader: __jsx(Loader, {\n      color: \"#009E7F\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 223,\n        columnNumber: 21\n      }\n    }),\n    style: {\n      minWidth: 135,\n      backgroundColor: '#ffffff',\n      border: '1px solid #f1f1f1',\n      color: '#009E7F'\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 217,\n      columnNumber: 11\n    }\n  })));\n};\n\n_s(Products, \"ueba3JWNO7pCfJpEXFd18E8kiNE=\", false, function () {\n  return [useRouter, useQuery];\n});\n\n_c3 = Products;\nexport default Products;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"QuickView$dynamic\");\n$RefreshReg$(_c2, \"QuickView\");\n$RefreshReg$(_c3, \"Products\");","map":{"version":3,"sources":["/home/roma/Documents/shop/containers/Products/Products.tsx"],"names":["React","useState","useRouter","dynamic","gql","openModal","closeModal","ProductCard","ProductsRow","ProductsCol","ButtonWrapper","LoaderWrapper","LoaderItem","ProductCardWrapper","CURRENCY","useQuery","Button","Loader","Placeholder","Fade","NoResultFound","QuickView","GET_PRODUCTS","Products","deviceType","type","fetchLimit","loadMore","router","loadingMore","toggleLoading","data","error","loading","fetchMore","productList","map","item","discountInPercent","discountPercent","handleModalClose","as","asPath","push","shallow","handleQuickViewModal","modalProps","onModalClose","pathname","slug","show","overlayClassName","closeOnClickOutside","component","componentProps","closeComponent","config","enableResizing","disableDragging","className","width","y","height","transition","mass","tension","friction","href","message","length","handleLoadMore","variables","offset","Number","limit","updateQuery","prev","fetchMoreResult","products","__typename","items","hasMore","index","title","description","image","unit","price","salePrice","minWidth","backgroundColor","border","color"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { useRouter } from 'next/router';\nimport dynamic from 'next/dynamic';\nimport gql from 'graphql-tag';\nimport { openModal, closeModal } from '@redq/reuse-modal';\nimport ProductCard from 'components/ProductCard/ProductCard';\nimport {\n  ProductsRow,\n  ProductsCol,\n  ButtonWrapper,\n  LoaderWrapper,\n  LoaderItem,\n  ProductCardWrapper,\n} from './Products.style';\nimport { CURRENCY } from 'helper/constant';\nimport { useQuery } from '@apollo/react-hooks';\nimport Button from 'components/Button/Button';\nimport Loader from 'components/Loader/Loader';\nimport Placeholder from 'components/Placeholder/Placeholder';\nimport Fade from 'react-reveal/Fade';\nimport NoResultFound from 'components/NoResult/NoResult';\nimport fakeDB from '../../helper/fakeDB';\n\nconst QuickView = dynamic(() => import('../QuickView/QuickView'));\n\nconst GET_PRODUCTS = gql`\n  query {\n    productList{\n      id\n      title\n      slug\n      description\n      Type\n      category{\n        id\n        title\n        slug\n        parent{\n          id\n          title\n          slug\n        }\n      }\n      unit\n      image\n      price\n      salePrice\n      discountPercent\n      createdAt\n      images{\n        image\n      }\n    }\n  }\n`;\n\ntype ProductsProps = {\n  deviceType?: {\n    mobile: boolean;\n    tablet: boolean;\n    desktop: boolean;\n  };\n  type: string;\n  fetchLimit?: number;\n  loadMore?: boolean;\n};\nexport const Products: React.FC<ProductsProps> = ({\n  deviceType,\n  type,\n  fetchLimit = 8,\n  loadMore = true,\n}) => {\n  const router = useRouter();\n  const [loadingMore, toggleLoading] = useState(false);\n  let { data, error, loading, fetchMore } = useQuery(GET_PRODUCTS, {\n    // variables: {\n    //   type: type,\n    //   text: router.query.text,\n    //   category: router.query.category,\n    //   offset: 0,\n    //   limit: fetchLimit,\n    // },\n  });\n  if(data){\n    data = data.productList.map(item=>({...item, discountInPercent: item.discountPercent}))\n  }\n// ------------------------------------------------------------------------------------------\n  // const data = {\n  //   products:{\n  //     hasMore:false,\n  //     items: fakeDB\n  //   },\n  // };\n  // const error = false;\n  // const loading = false;\n  // const fetchMore = (obj)=>{};\n// ------------------------------------------------------------------------------------------\n  // Quick View Modal\n  const handleModalClose = () => {\n    const as = router.asPath;\n    router.push(as, as, { shallow: true });\n    closeModal();\n  };\n\n  const handleQuickViewModal = (\n    modalProps: any,\n    deviceType: any,\n    onModalClose: any\n  ) => {\n    if (router.pathname === '/product/[slug]') {\n      const as = `/product/${modalProps.slug}`;\n      router.push(router.pathname, as);\n      return;\n    }\n    openModal({\n      show: true,\n      overlayClassName: 'quick-view-overlay',\n      closeOnClickOutside: false,\n      component: QuickView,\n      componentProps: { modalProps, deviceType, onModalClose },\n      closeComponent: 'div',\n      config: {\n        enableResizing: false,\n        disableDragging: true,\n        className: 'quick-view-modal',\n        width: 900,\n        y: 30,\n        height: 'auto',\n        transition: {\n          mass: 1,\n          tension: 0,\n          friction: 0,\n        },\n      },\n    });\n    const href = router.asPath;\n    const as = `/product/${modalProps.slug}`;\n    router.push(href, as, { shallow: true });\n  };\n\n  if (loading) {\n    return (\n      <LoaderWrapper>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n        <LoaderItem>\n          <Placeholder />\n        </LoaderItem>\n      </LoaderWrapper>\n    );\n  }\n\n  if (error){return <div>{error.message}</div>};\n  if (!data || !data.productList || data.productList.length === 0) {\n    return <NoResultFound />;\n  }\n  const handleLoadMore = () => {\n    toggleLoading(true);\n    fetchMore({\n      variables: {\n        offset: Number(data.productList.length),\n        limit: fetchLimit,\n      },\n      updateQuery: (prev, { fetchMoreResult }) => {\n        toggleLoading(false);\n        if (!fetchMoreResult) {\n          return prev;\n        }\n        return {\n          products: {\n            __typename: prev.products.__typename,\n            items: [...prev.products.items, ...fetchMoreResult.products.items],\n            hasMore: fetchMoreResult.products.hasMore,\n          },\n        };\n      },\n    });\n  };\n\n  return (\n    <>\n      <ProductsRow>\n        {data.productList.map((item: any, index: number) => (\n          <ProductsCol key={index}>\n            <ProductCardWrapper>\n              <Fade\n                duration={800}\n                delay={index * 10}\n                style={{ height: '100%' }}\n              >\n                <ProductCard\n                  title={item.title}\n                  description={item.description}\n                  image={item.image}\n                  weight={item.unit}\n                  currency={CURRENCY}\n                  price={item.price}\n                  salePrice={item.salePrice}\n                  discountInPercent={item.discountInPercent}\n                  data={item}\n                  deviceType={deviceType}\n                  onClick={() =>\n                    handleQuickViewModal(item, deviceType, handleModalClose)\n                  }\n                />\n              </Fade>\n            </ProductCardWrapper>\n          </ProductsCol>\n        ))}\n      </ProductsRow>\n      {loadMore && data.hasMore && (\n        <ButtonWrapper>\n          <Button\n            onClick={handleLoadMore}\n            title=\"Load More\"\n            intlButtonId=\"loadMoreBtn\"\n            size=\"small\"\n            isLoading={loadingMore}\n            loader={<Loader color=\"#009E7F\" />}\n            style={{\n              minWidth: 135,\n              backgroundColor: '#ffffff',\n              border: '1px solid #f1f1f1',\n              color: '#009E7F',\n            }}\n          />\n        </ButtonWrapper>\n      )}\n    </>\n  );\n};\nexport default Products;\n"]},"metadata":{},"sourceType":"module"}