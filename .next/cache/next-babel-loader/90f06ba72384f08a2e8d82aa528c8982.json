{"ast":null,"code":"var _jsxFileName = \"/Users/pipi/Documents/pr/react_apps/shop/contexts/cart/use-cart.tsx\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice } from './cart.reducer'; // import { useStorage } from 'helper/use-storage';\n\nconst CartContext = createContext({});\nexport const getLocalCart = () => {\n  try {\n    let val = localStorage.getItem(\"cart\");\n    if (!val || val === \"null\") return [];\n    const json = JSON.parse(val);\n    return json;\n  } catch (e) {\n    return [];\n  }\n};\nconsole.log(getLocalCart());\nconst INITIAL_STATE = {\n  isOpen: false,\n  items: getLocalCart(),\n  coupon: null,\n  count: getLocalCart().length\n};\n\nconst useCartActions = (initialCart = INITIAL_STATE) => {\n  var _state$items3;\n\n  const {\n    0: state,\n    1: dispatch\n  } = useReducer(reducer, initialCart);\n\n  const addItemHandler = (item, quantity = 1) => {\n    dispatch({\n      type: 'ADD_ITEM',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        quantity\n      })\n    });\n  };\n\n  const refreshCart = () => dispatch({\n    type: \"REFRESH_CART\",\n    payload: getLocalCart()\n  });\n\n  const removeItemHandler = (item, quantity = 1) => {\n    dispatch({\n      type: 'REMOVE_ITEM',\n      payload: _objectSpread(_objectSpread({}, item), {}, {\n        quantity\n      })\n    });\n  };\n\n  const clearItemFromCartHandler = item => {\n    dispatch({\n      type: 'CLEAR_ITEM_FROM_CART',\n      payload: item\n    });\n  };\n\n  const clearCartHandler = () => {\n    dispatch({\n      type: 'CLEAR_CART'\n    });\n  };\n\n  const toggleCartHandler = () => {\n    dispatch({\n      type: 'TOGGLE_CART'\n    });\n  };\n\n  const couponHandler = coupon => {\n    dispatch({\n      type: 'APPLY_COUPON',\n      payload: coupon\n    });\n  };\n\n  const removeCouponHandler = () => {\n    dispatch({\n      type: 'REMOVE_COUPON'\n    });\n  };\n\n  const rehydrateLocalState = payload => {\n    dispatch({\n      type: 'REHYDRATE',\n      payload\n    });\n  };\n\n  const isInCartHandler = id => {\n    var _state$items;\n\n    return (_state$items = state.items) === null || _state$items === void 0 ? void 0 : _state$items.some(item => item.id === id);\n  };\n\n  const getItemHandler = id => {\n    var _state$items2;\n\n    return (_state$items2 = state.items) === null || _state$items2 === void 0 ? void 0 : _state$items2.find(item => item.id === id);\n  };\n\n  const getCartItemsPrice = () => cartItemsTotalPrice(state.items).toFixed(2);\n\n  const getCartItemsTotalPrice = () => cartItemsTotalPrice(state.items, state.coupon).toFixed(2);\n\n  const getDiscount = () => {\n    var _state$coupon;\n\n    const total = cartItemsTotalPrice(state.items);\n    const discount = state.coupon ? total * Number((_state$coupon = state.coupon) === null || _state$coupon === void 0 ? void 0 : _state$coupon.discountInPercent) / 100 : 0;\n    return discount.toFixed(2);\n  };\n\n  const getItemsCount = (_state$items3 = state.items) === null || _state$items3 === void 0 ? void 0 : _state$items3.reduce((acc, item) => acc + item.quantity, 0);\n  return {\n    state,\n    getItemsCount,\n    rehydrateLocalState,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    getCartItemsPrice,\n    couponHandler,\n    removeCouponHandler,\n    getDiscount,\n    refreshCart\n  };\n};\n\nexport const CartProvider = ({\n  children\n}) => {\n  var _state$items4;\n\n  const {\n    state,\n    rehydrateLocalState,\n    getItemsCount,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    couponHandler,\n    removeCouponHandler,\n    getCartItemsPrice,\n    getDiscount,\n    refreshCart\n  } = useCartActions(); // const { rehydrated, error } = useStorage(state, rehydrateLocalState);\n\n  return __jsx(CartContext.Provider, {\n    value: {\n      isOpen: state.isOpen,\n      items: state.items,\n      coupon: state.coupon,\n      cartItemsCount: state.items.length,\n      itemsCount: getItemsCount,\n      getCartItemsCount: ((_state$items4 = state.items) === null || _state$items4 === void 0 ? void 0 : _state$items4.length) ? state.items.reduce((a, b) => a + b.quantity, 0) : null,\n      addItem: addItemHandler,\n      removeItem: removeItemHandler,\n      removeItemFromCart: clearItemFromCartHandler,\n      clearCart: clearCartHandler,\n      isInCart: isInCartHandler,\n      getItem: getItemHandler,\n      toggleCart: toggleCartHandler,\n      calculatePrice: getCartItemsTotalPrice,\n      calculateSubTotalPrice: getCartItemsPrice,\n      applyCoupon: couponHandler,\n      removeCoupon: removeCouponHandler,\n      calculateDiscount: getDiscount,\n      refreshCart,\n      rehydrateLocalState\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 5\n    }\n  }, children);\n};\nexport const useCart = () => useContext(CartContext);","map":{"version":3,"sources":["/Users/pipi/Documents/pr/react_apps/shop/contexts/cart/use-cart.tsx"],"names":["React","useReducer","useContext","createContext","reducer","cartItemsTotalPrice","CartContext","getLocalCart","val","localStorage","getItem","json","JSON","parse","e","console","log","INITIAL_STATE","isOpen","items","coupon","count","length","useCartActions","initialCart","state","dispatch","addItemHandler","item","quantity","type","payload","refreshCart","removeItemHandler","clearItemFromCartHandler","clearCartHandler","toggleCartHandler","couponHandler","removeCouponHandler","rehydrateLocalState","isInCartHandler","id","some","getItemHandler","find","getCartItemsPrice","toFixed","getCartItemsTotalPrice","getDiscount","total","discount","Number","discountInPercent","getItemsCount","reduce","acc","CartProvider","children","cartItemsCount","itemsCount","getCartItemsCount","a","b","addItem","removeItem","removeItemFromCart","clearCart","isInCart","toggleCart","calculatePrice","calculateSubTotalPrice","applyCoupon","removeCoupon","calculateDiscount","useCart"],"mappings":"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","sourcesContent":["import React, { useReducer, useContext, createContext } from 'react';\nimport { reducer, cartItemsTotalPrice } from './cart.reducer';\n// import { useStorage } from 'helper/use-storage';\nconst CartContext = createContext({} as any);\n\nexport const getLocalCart = ()=>{\n  try {\n    let val = localStorage.getItem(\"cart\");\n    if(!val || val === \"null\")return [];\n    const json = JSON.parse(val);\n    return json;\n  } catch (e) {\n    return [];\n  }\n};\n\nconsole.log(getLocalCart())\n\nconst INITIAL_STATE = {\n  isOpen: false,\n  items: getLocalCart(),\n  coupon: null,\n  count: getLocalCart().length\n};\n\nconst useCartActions = (initialCart = INITIAL_STATE) => {\n  const [state, dispatch] = useReducer(reducer, initialCart);\n\n  const addItemHandler = (item:any, quantity = 1) => {\n    dispatch({ type: 'ADD_ITEM', payload: { ...item, quantity } });\n  };\n\n  const refreshCart = ()=>dispatch({type: \"REFRESH_CART\", payload: getLocalCart()});\n\n  const removeItemHandler = (item:any, quantity = 1) => {\n    dispatch({ type: 'REMOVE_ITEM', payload: { ...item, quantity } });\n  };\n\n  const clearItemFromCartHandler = (item:any) => {\n    dispatch({ type: 'CLEAR_ITEM_FROM_CART', payload: item });\n  };\n\n  const clearCartHandler = () => {\n    dispatch({ type: 'CLEAR_CART' });\n  };\n  const toggleCartHandler = () => {\n    dispatch({ type: 'TOGGLE_CART' });\n  };\n  const couponHandler = (coupon:any) => {\n    dispatch({ type: 'APPLY_COUPON', payload: coupon });\n  };\n  const removeCouponHandler = () => {\n    dispatch({ type: 'REMOVE_COUPON' });\n  };\n  const rehydrateLocalState = (payload:any) => {\n    dispatch({ type: 'REHYDRATE', payload });\n  };\n  const isInCartHandler = (id:any) => {\n    return state.items?.some((item:any) => item.id === id);\n  };\n  const getItemHandler = (id:any) => {\n    return state.items?.find((item:any) => item.id === id);\n  };\n  const getCartItemsPrice = () => cartItemsTotalPrice(state.items).toFixed(2);\n  const getCartItemsTotalPrice = () =>\n    cartItemsTotalPrice(state.items, state.coupon).toFixed(2);\n\n  const getDiscount = () => {\n    const total = cartItemsTotalPrice(state.items);\n    const discount = state.coupon\n      ? (total * Number(state.coupon?.discountInPercent)) / 100\n      : 0;\n    return discount.toFixed(2);\n  };\n  const getItemsCount = state.items?.reduce(\n    (acc:any, item:any) => acc + item.quantity,\n    0\n  );\n  return {\n    state,\n    getItemsCount,\n    rehydrateLocalState,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    getCartItemsPrice,\n    couponHandler,\n    removeCouponHandler,\n    getDiscount,\n    refreshCart,\n  };\n};\n\nexport const CartProvider = ({ children }) => {\n  const {\n    state,\n    rehydrateLocalState,\n    getItemsCount,\n    addItemHandler,\n    removeItemHandler,\n    clearItemFromCartHandler,\n    clearCartHandler,\n    isInCartHandler,\n    getItemHandler,\n    toggleCartHandler,\n    getCartItemsTotalPrice,\n    couponHandler,\n    removeCouponHandler,\n    getCartItemsPrice,\n    getDiscount,\n    refreshCart\n  } = useCartActions();\n  // const { rehydrated, error } = useStorage(state, rehydrateLocalState);\n\n  return (\n    <CartContext.Provider\n      value={{\n        isOpen: state.isOpen,\n        items: state.items,\n        coupon: state.coupon,\n        cartItemsCount: state.items.length,\n        itemsCount: getItemsCount,\n        getCartItemsCount: state.items?.length ? state.items.reduce((a:Number,b:any)=>a+b.quantity,0): null,\n        addItem: addItemHandler,\n        removeItem: removeItemHandler,\n        removeItemFromCart: clearItemFromCartHandler,\n        clearCart: clearCartHandler,\n        isInCart: isInCartHandler,\n        getItem: getItemHandler,\n        toggleCart: toggleCartHandler,\n        calculatePrice: getCartItemsTotalPrice,\n        calculateSubTotalPrice: getCartItemsPrice,\n        applyCoupon: couponHandler,\n        removeCoupon: removeCouponHandler,\n        calculateDiscount: getDiscount,\n        refreshCart,\n        rehydrateLocalState,\n      }}\n    >\n      {children}\n    </CartContext.Provider>\n  );\n};\n\nexport const useCart = () => useContext(CartContext);\n"]},"metadata":{},"sourceType":"module"}