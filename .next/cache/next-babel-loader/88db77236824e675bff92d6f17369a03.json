{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/esm/slicedToArray\";\nimport _taggedTemplateLiteral from \"@babel/runtime/helpers/esm/taggedTemplateLiteral\";\nvar __jsx = React.createElement;\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _templateObject() {\n  var data = _taggedTemplateLiteral([\"\\n  mutation applyCoupon($code: String!) {\\n    applyCoupon(code: $code) {\\n      id\\n      code\\n      discountInPercent\\n    }\\n  }\\n\"]);\n\n  _templateObject = function _templateObject() {\n    return data;\n  };\n\n  return data;\n}\n\nimport React, { useState } from 'react';\nimport Link from 'next/link';\nimport gql from 'graphql-tag';\nimport { useMutation } from '@apollo/react-hooks';\nimport { CartPopupBody, PopupHeader, PopupItemCount, CloseButton, PromoCode, CheckoutButtonWrapper, CheckoutButton, Title, PriceBox, NoProductMsg, ItemWrapper, CouponBoxWrapper, CouponCode, ErrorMsg } from './CartItemCard.style';\nimport { CloseIcon } from 'components/AllSvgIcon';\nimport { ShoppingBagLarge } from 'components/AllSvgIcon';\nimport { CURRENCY } from 'helper/constant';\nimport { FormattedMessage } from 'react-intl';\nimport { useLocale } from 'contexts/language/language.provider';\nimport CouponBox from 'components/CouponBox/CouponBox';\nimport { Scrollbars } from 'react-custom-scrollbars';\nimport { useCart } from 'contexts/cart/use-cart';\nimport { CartItem } from './CartItem/CartItem';\nvar APPLY_COUPON = gql(_templateObject());\n\nvar Cart = function Cart(_ref) {\n  var style = _ref.style,\n      className = _ref.className,\n      onCloseBtnClick = _ref.onCloseBtnClick,\n      scrollbarHeight = _ref.scrollbarHeight;\n\n  var _useCart = useCart(),\n      items = _useCart.items,\n      coupon = _useCart.coupon,\n      addItem = _useCart.addItem,\n      removeItem = _useCart.removeItem,\n      removeItemFromCart = _useCart.removeItemFromCart,\n      cartItemsCount = _useCart.cartItemsCount,\n      calculatePrice = _useCart.calculatePrice,\n      applyCoupon = _useCart.applyCoupon;\n\n  var _useState = useState(''),\n      couponText = _useState[0],\n      setCoupon = _useState[1];\n\n  var _useState2 = useState(false),\n      displayCoupon = _useState2[0],\n      showCoupon = _useState2[1];\n\n  var _useState3 = useState(''),\n      error = _useState3[0],\n      setError = _useState3[1];\n\n  var _useMutation = useMutation(APPLY_COUPON),\n      _useMutation2 = _slicedToArray(_useMutation, 1),\n      applyedCoupon = _useMutation2[0];\n\n  var _useLocale = useLocale(),\n      isRtl = _useLocale.isRtl;\n\n  var handleApplyCoupon = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$applyedCoupon, data;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return applyedCoupon({\n                variables: {\n                  code: couponText\n                }\n              });\n\n            case 2:\n              _yield$applyedCoupon = _context.sent;\n              data = _yield$applyedCoupon.data;\n\n              if (data.applyCoupon && data.applyCoupon.discountInPercent) {\n                setError('');\n                applyCoupon(data.applyCoupon);\n                setCoupon('');\n              } else {\n                setError('Invalid Coupon');\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function handleApplyCoupon() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  var handleChange = function handleChange(value) {\n    setCoupon(value);\n  };\n\n  var toggleCoupon = function toggleCoupon() {\n    showCoupon(true);\n  };\n\n  return __jsx(CartPopupBody, {\n    className: className,\n    style: style\n  }, __jsx(PopupHeader, null, __jsx(PopupItemCount, null, __jsx(ShoppingBagLarge, {\n    width: \"19px\",\n    height: \"24px\"\n  }), __jsx(\"span\", null, cartItemsCount, \"\\xA0\", cartItemsCount > 1 ? __jsx(FormattedMessage, {\n    id: \"cartItems\",\n    defaultMessage: \"items\"\n  }) : __jsx(FormattedMessage, {\n    id: \"cartItem\",\n    defaultMessage: \"item\"\n  }))), __jsx(CloseButton, {\n    onClick: onCloseBtnClick\n  }, __jsx(CloseIcon, null))), __jsx(Scrollbars, {\n    universal: true,\n    autoHide: true,\n    autoHeight: true,\n    autoHeightMax: scrollbarHeight,\n    renderView: function renderView(props) {\n      return __jsx(\"div\", _extends({}, props, {\n        style: _objectSpread(_objectSpread({}, props.style), {}, {\n          marginLeft: isRtl ? props.style.marginRight : 0,\n          marginRight: isRtl ? 0 : props.style.marginRight\n        })\n      }));\n    }\n  }, __jsx(ItemWrapper, null, !!cartItemsCount ? items.map(function (item) {\n    return __jsx(CartItem, {\n      key: \"cartItem-\".concat(item.id),\n      onIncrement: function onIncrement() {\n        return addItem(item);\n      },\n      onDecrement: function onDecrement() {\n        return removeItem(item);\n      },\n      onRemove: function onRemove() {\n        return removeItemFromCart(item);\n      },\n      data: item\n    });\n  }) : __jsx(NoProductMsg, null, __jsx(FormattedMessage, {\n    id: \"noProductFound\",\n    defaultMessage: \"No products found\"\n  })))), __jsx(CheckoutButtonWrapper, null, __jsx(PromoCode, null, !(coupon === null || coupon === void 0 ? void 0 : coupon.discountInPercent) ? __jsx(React.Fragment, null, !displayCoupon ? __jsx(\"button\", {\n    onClick: toggleCoupon\n  }, __jsx(FormattedMessage, {\n    id: \"specialCode\",\n    defaultMessage: \"Have a special code?\"\n  })) : __jsx(CouponBoxWrapper, null, __jsx(CouponBox, {\n    onUpdate: handleChange,\n    value: couponText,\n    onClick: handleApplyCoupon,\n    disabled: !couponText.length || !items.length,\n    buttonTitle: \"Apply\",\n    intlCouponBoxPlaceholder: \"couponPlaceholder\",\n    style: {\n      boxShadow: '0 3px 6px rgba(0, 0, 0, 0.06)'\n    }\n  }), error ? __jsx(ErrorMsg, null, error) : '')) : __jsx(CouponCode, null, __jsx(FormattedMessage, {\n    id: \"couponApplied\",\n    defaultMessage: \"Coupon Applied\"\n  }), __jsx(\"span\", null, coupon.code))), cartItemsCount !== 0 ? __jsx(Link, {\n    href: \"/checkout\"\n  }, __jsx(CheckoutButton, {\n    onClick: onCloseBtnClick\n  }, __jsx(React.Fragment, null, __jsx(Title, null, __jsx(FormattedMessage, {\n    id: \"navlinkCheckout\",\n    defaultMessage: \"Checkout\"\n  })), __jsx(PriceBox, null, CURRENCY, calculatePrice())))) : __jsx(CheckoutButton, null, __jsx(React.Fragment, null, __jsx(Title, null, __jsx(FormattedMessage, {\n    id: \"navlinkCheckout\",\n    defaultMessage: \"Checkout\"\n  })), __jsx(PriceBox, null, CURRENCY, calculatePrice())))));\n};\n\nexport default Cart;","map":null,"metadata":{},"sourceType":"module"}